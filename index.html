<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Transport Accessibility Framework</title>
  <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
  <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/noUiSlider/15.5.0/nouislider.min.css" />
  <script src="https://cdnjs.cloudflare.com/ajax/libs/noUiSlider/15.5.0/nouislider.min.js"></script>
  <style>
    html, body {
      height: 100%;
      margin: 0;
      padding: 0;
      font-family: 'Trebuchet MS', sans-serif;
      font-weight: normal; /* Ensure font is not bold */
    }
    #map {
      height: 100%;
      width: 100%;
    }
    #panel-container {
      position: absolute;
      top: 10px;
      left: 10px;
      z-index: 1000; /* Ensure the controls are always on top */
      background: white;
      padding: 10px;
      border-radius: 5px;
      box-shadow: 0 0 10px rgba(0, 0, 0, 0.5);
      width: 275px;
      box-sizing: border-box;
    }
    .panel {
      margin-bottom: 10px;
    }
    .panel label, .panel select, .panel input {
      display: block;
      margin-bottom: 5px; /* Reduce space between elements */
      font-family: 'Trebuchet MS', sans-serif;
      font-size: 1.1em; /* Large font size */
      font-weight: normal; /* Ensure font is not bold */
    }
    .panel select, .panel input {
      width: 100%;
      padding: 5px;
      border: 1px solid #ccc;
      border-radius: 3px;
      background-color: white;
      color: black;
      box-sizing: border-box;
      font-size: 1em; /* Medium font size */
    }
    .panel select:focus, .panel input:focus {
      outline: none;
      border-color: #007bff;
      box-shadow: 0 0 5px rgba(0, 123, 255, 0.5);
    }
    .panel input[type="range"] {
      width: 100%;
    }
    .field-container {
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    .field-container > div:first-child {
      flex: 1.05;
    }
    .field-container > div:last-child {
      flex: 0.95;
      margin-left: 10px;
    }
    .button-container {
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    .button-container > button {
      flex: 1;
      margin-left: 10px;
    }
    .button-container > button:first-child {
      margin-left: 0;
    }
    .collapsible {
      cursor: pointer;
      border: none;
      text-align: left;
      outline: none;
      font-size: 1em; /* Larger font size for Settings */
      background: #f0f0f0;
      margin-bottom: 10px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 10px;
      border-radius: 5px;
      font-family: 'Trebuchet MS', sans-serif;
      font-weight: normal; /* Ensure font is not bold */
    }
    .collapsible:after {
      content: '\25BC';
      font-size: 0.9em;
      margin-left: 5px;
    }
    .collapsible.collapsed:after {
      content: '\25B6';
    }
    .collapsible-content {
      display: none;
      overflow: hidden;
      background-color: #f0f0f0;
      padding: 10px;
      border-radius: 5px;
      font-size: 0.9em; /* Small font size */
    }
    #legend {
      position: absolute;
      top: 10px;
      right: 10px;
      background: white;
      padding: 5px;
      border-radius: 5px;
      box-shadow: 0 0 10px rgba(0, 0, 0, 0.5);
      z-index: 1000;
      width: 250px;
      word-wrap: break-word;
    }
    .noUi-target {
      background: #f0f0f0; /* Background of the slider */
      border-radius: 5px;
      box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.1);
      height: 0.5em;
    }
    .noUi-connect {
      background: linear-gradient(to right, rgba(118, 118, 118, 0) 0%, rgba(118, 118, 118, 1) 50%, #767676 50%);
      height: 0.5em;
    }
    .noUi-connect-right-solid {
      background: #767676 !important; /* Solid grey fill */
    }
    .noUi-handle {
      background: #767676 !important; /* Handle color */
      border: none !important;
      border-radius: 50% !important;
      box-shadow: none !important;
      width: 14px !important; /* Adjust this value if needed */
      height: 14px !important; /* Adjust this value if needed */
      cursor: pointer !important;
      top: 50%; /* Vertically center the handle */
      transform: translate(-50%, 5%) !important; /* Center the handle over its position */
    }
    .noUi-handle-left {
      background: rgba(255, 255, 255, 0.0) !important; /* Transparent inside */
      border: 2px solid #767676 !important; /* Grey outline */
    }
    .noUi-handle::after {
      content: attr(data-value);
      position: absolute;
      background: #007bff00;
      color: #000000;
      padding: 2px 5px;
      border: none;
      font-size: 0.8em;
      top:-17px;
      left: -10px; /* Move more to the left */
      transform: translateX(-50%); /* Center the text horizontally */
    }
    .slider-labels {
      display: flex;
      justify-content: space-between;
      margin-top: 5px;
    }
    .slider-labels span {
      font-size: 0.8em;
    }
    .noUi-tooltip {
      background: #007bff;
      color: #fff;
      border-radius: 3px;
      padding: 5px;
      font-size: 0.9em;
    }
    /* Specific styles for the settings panel */
    .collapsible-content label,
    .collapsible-content select,
    .collapsible-content input {
      font-size: 0.8em; /* Small font size */
      font-family: 'Trebuchet MS', sans-serif;
      font-weight: normal; /* Ensure font is not bold */
    }
    .panel-header {
      cursor: pointer;
      border: none;
      text-align: left;
      outline: none;
      font-size: 1.2em; /* Font size for Connectivity Scores */
      background: white;
      margin-bottom: 10px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 10px;
      border-radius: 5px;
      font-family: 'Trebuchet MS', sans-serif;
      font-weight: normal; /* Ensure font is not bold */
    }
    .panel-header:after {
      content: '\25BC';
      font-size: 0.9em;
      margin-left: 5px;
    }
    .panel-header.collapsed:after {
      content: '\25B6';
    }
  </style>
</head>
<body>
  <div id="map"></div>
  <div id="panel-container">
    <div id="panel" class="panel">
      <button class="panel-header">Connectivity Scores</button>
      <div id="panel-content">
        <label for="yearDropdown" class="large-font">Year:</label>
        <select id="yearDropdown" class="medium-font"></select>
        <br>
        <label for="purposeDropdown" class="large-font">Purpose of Travel:</label>
        <select id="purposeDropdown" class="medium-font">
          <option value="All Amenities">All Amenities</option>
          <option value="Education">Education</option>
          <option value="Employment">Employment</option>
          <option value="High Street">High Street</option>
          <option value="Health">Health</option>
        </select>
        <br>
        <label for="modeDropdown" class="large-font">Mode of Travel:</label>
        <select id="modeDropdown" class="medium-font">
          <option value="All Modes">All Modes</option>
          <option value="Walk">Walk</option>
          <option value="Cycle">Cycle</option>
          <option value="Public Transport">Public Transport</option>
          <option value="Car">Car</option>
        </select>
        <br>
        <button type="button" class="collapsible">Settings</button>
        <div class="collapsible-content">
          <label for="opacityFieldDropdown" class="medium-font">Set Hexagon Transparency to:</label>
          <select id="opacityFieldDropdown" class="small-font">
            <option value="None">None</option>
            <option value="pop">Population</option>
            <option value="imd">Index of Multiple Deprivation</option>
            <option value="carav">Car Availability</option>
            <option value="hh_fut">Future Dwellings</option>
          </select>
          <br>
          <div class="field-container">
            <div>
              <div id="opacityRangeSlider"></div>
              <div class="slider-labels">
                <span id="opacityRangeMin">0</span>
                <span id="opacityRangeMax">1</span>
              </div>
            </div>
          </div>
          <div class="field-container">
            <div class="button-container">
              <button id="inverseOpacityScaleButton" class="small-font">Inverse Scale</button>
            </div>
          </div>
          <br>
          <label for="outlineFieldDropdown" class="medium-font">Set Hexagon Outline to:</label>
          <select id="outlineFieldDropdown" class="small-font">
            <option value="None">None</option>
            <option value="imd">Index of Multiple Deprivation</option>
            <option value="pop">Population</option>
            <option value="carav">Car Availability</option>
            <option value="hh_fut">Future Dwellings</option>
          </select>
          <br>
          <div class="field-container">
            <div>
              <div id="outlineRangeSlider"></div>
              <div class="slider-labels">
                <span id="outlineRangeMin">0</span>
                <span id="outlineRangeMax">4</span>
              </div>
            </div>
          </div>
          <div class="field-container">
            <div class="button-container">
              <button id="inverseOutlineScaleButton" class="small-font">Inverse Scale</button>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div id="panel-amenities" class="panel">
      <button class="panel-header">Journey Time Catchments - Amenities</button>
      <div id="panel-amenities-content"></div>
    </div>
    <div id="panel-hexagons" class="panel">
      <button class="panel-header">Journey Time Catchments - Hexagons</button>
      <div id="panel-hexagons-content"></div>
    </div>
  </div>
  <div id="legend">
    <h4 style="font-size: 1.2em; margin-top: 0;">Legend</h4>
    <div id="legend-content"></div>
  </div>
  <script src="main.js"></script>
  <script>
    document.addEventListener('DOMContentLoaded', (event) => {
      // Handle collapsible settings panel
      const collapsible = document.querySelector(".collapsible");
      const content = document.querySelector(".collapsible-content");

      collapsible.addEventListener("click", function() {
        this.classList.toggle("active");
        content.style.display = content.style.display === "block" ? "none" : "block";
        this.classList.toggle("collapsed", content.style.display === "none");
      });

      // Handle collapsible panels
      const panelHeaders = document.querySelectorAll(".panel-header");
      panelHeaders.forEach(header => {
        const panelContent = header.nextElementSibling;
        header.addEventListener("click", function() {
          // Collapse all other panels
          panelHeaders.forEach(otherHeader => {
            if (otherHeader !== header) {
              otherHeader.classList.add("collapsed");
              otherHeader.nextElementSibling.style.display = "none";
            }
          });
          // Toggle the clicked panel
          panelContent.style.display = panelContent.style.display === "block" ? "none" : "block";
          header.classList.toggle("collapsed", panelContent.style.display === "none");
        });
        // Initially collapse the panel content
        panelContent.style.display = "none";
        header.classList.add("collapsed");
      });

      // Initially collapse the settings content
      content.style.display = "none";
      collapsible.classList.add("collapsed");
    });
  </script>
</body>
</html>
